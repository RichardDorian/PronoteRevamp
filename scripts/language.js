// TODO: Make separate file for translations
const translations = {
  en: {
    // Login page
    'login-text-description':
      'It’s like the default Pronote app, but cooler :D\nPlease login using your credentials:',
    'login-placeholder-username': 'Username',
    'login-placeholder-password': 'Password',
    'login-value-sign-in': 'Sign In',
    'login-text-credits': 'Coded and maintained\nby RichardDorian',
    // Main Menu
    'mainmenu-text-main-menu': 'Main Menu',
    'mainmenu-value-timetable': 'Timetable',
    'mainmenu-value-homework': 'Homework',
    'mainmenu-value-grades': 'Grades',
    'mainmenu-value-menu': 'Menu',
    'mainmenu-value-teachers': 'Teachers',
    // Settings
    'settings-value-title': 'Settings',
    'settings-value-application': 'Application',
    'settings-value-notifications': 'Notifications',
    'settings-value-credits': 'Credits',
    'settings-text-theme': 'Theme',
    'settings-text-theme-system': 'System default',
    'settings-text-theme-light': 'Light',
    'settings-text-theme-dark': 'Dark',
    'settings-text-theme-oled': 'OLED',
    'settings-text-language': 'Language',
    'settings-text-language-system': 'System default',
    'settings-text-language-french': 'French',
    'settings-text-language-english': 'English',
    'settings-text-language-spanish': 'Spanish',
    // Time table
    'timetable-value-title': 'Timetable',
    'timetable-text-days-monday-short': 'Mon',
    'timetable-text-days-tuesday-short': 'Tue',
    'timetable-text-days-wednesday-short': 'Wed',
    'timetable-text-days-thursday-short': 'Thu',
    'timetable-text-days-friday-short': 'Fri',
    'timetable-text-days-monday': 'Monday',
    'timetable-text-days-tuesday': 'Tuesday',
    'timetable-text-days-wednesday': 'Wednesday',
    'timetable-text-days-thursday': 'Thursday',
    'timetable-text-days-friday': 'Friday',
    'homework-value-title': 'Homework',
    'grades-value-title': 'Grades',
    'menu-value-title': 'Menu',
    'teachers-value-title': 'Teachers',
    'share-application-description':
      'Check out the Pronote Revamp app! Better interface, better experience, notifications and more!',
  },
  fr: {
    'login-text-description':
      'C’est comme l’application Pronote par défaut, mais plus cool :D\nVeuillez vous connecter avec vos identifiants:',
    'login-placeholder-username': 'Nom d’utilisateur',
    'login-placeholder-password': 'Mot de passe',
    'login-value-sign-in': 'Se connecter',
    'login-text-credits': 'Codé et maintenu\npar RichardDorian',
    'mainmenu-text-main-menu': 'Menu principal',
    'mainmenu-value-timetable': 'E.D.T.',
    'mainmenu-value-homework': 'Devoirs',
    'mainmenu-value-grades': 'Notes',
    'mainmenu-value-menu': 'Menu',
    'mainmenu-value-teachers': 'Enseignants',
    'settings-value-title': 'Paramètres',
    'settings-value-application': 'Application',
    'settings-value-notifications': 'Notifications',
    'settings-value-credits': 'Crédits',
    'settings-text-theme': 'Thème',
    'settings-text-theme-system': 'Défaut système',
    'settings-text-theme-light': 'Clair',
    'settings-text-theme-dark': 'Sombre',
    'settings-text-theme-oled': 'OLED',
    'settings-text-language': 'Langue',
    'settings-text-language-system': 'Défaut système',
    'settings-text-language-french': 'Français',
    'settings-text-language-english': 'Anglais',
    'settings-text-language-spanish': 'Espagnol',
    'timetable-value-title': 'E.D.T.',
    'timetable-text-days-monday-short': 'Lun',
    'timetable-text-days-tuesday-short': 'Mar',
    'timetable-text-days-wednesday-short': 'Mer',
    'timetable-text-days-thursday-short': 'Jeu',
    'timetable-text-days-friday-short': 'Ven',
    'timetable-text-days-monday': 'Lundi',
    'timetable-text-days-tuesday': 'Mardi',
    'timetable-text-days-wednesday': 'Mercredi',
    'timetable-text-days-thursday': 'Jeudi',
    'timetable-text-days-friday': 'Vendredi',
    'homework-value-title': 'Devoirs',
    'grades-value-title': 'Notes',
    'menu-value-title': 'Menu',
    'teachers-value-title': 'Enseignants',
    'share-application-description':
      'Découvrez l’application Pronote Revamp ! Une interface plus belle, une expérience plus agréable, des notifications et plus !',
  },
  es: {
    'login-text-description':
      'Es como la aplicación Pronote por defecto, pero más cool :D\nInicie sesión con sus credenciales:',
    'login-placeholder-username': 'Nombre de usuario',
    'login-placeholder-password': 'Contraseña',
    'login-value-sign-in': 'Iniciar sesión',
    'login-text-credits': 'Codificado y mantenido\npor RichardDorian',
    'mainmenu-text-main-menu': 'Menú principal',
    'mainmenu-value-timetable': 'Horario',
    'mainmenu-value-homework': 'Tareas',
    'mainmenu-value-grades': 'Notas',
    'mainmenu-value-menu': 'Menú',
    'mainmenu-value-teachers': 'Profesores',
    'settings-value-title': 'Ajustes',
    'settings-value-application': 'Aplicación',
    'settings-value-notifications': 'Notificaciones',
    'settings-value-credits': 'Créditos',
    'settings-text-theme': 'Tema',
    'settings-text-theme-system': 'Por defecto del sistema',
    'settings-text-theme-light': 'Claro',
    'settings-text-theme-dark': 'Oscuro',
    'settings-text-theme-oled': 'OLED',
    'settings-text-language': 'Idioma',
    'settings-text-language-system': 'Por defecto del sistema',
    'settings-text-language-french': 'Francés',
    'settings-text-language-english': 'Inglés',
    'settings-text-language-spanish': 'Español',
    'timetable-value-title': 'Horario',
    'timetable-text-days-monday-short': 'Lun',
    'timetable-text-days-tuesday-short': 'Mar',
    'timetable-text-days-wednesday-short': 'Mié',
    'timetable-text-days-thursday-short': 'Jue',
    'timetable-text-days-friday-short': 'Vie',
    'timetable-text-days-monday': 'Lunes',
    'timetable-text-days-tuesday': 'Martes',
    'timetable-text-days-wednesday': 'Miércoles',
    'timetable-text-days-thursday': 'Jueves',
    'timetable-text-days-friday': 'Viernes',
    'homework-value-title': 'Tareas',
    'grades-value-title': 'Notas',
    'menu-value-title': 'Menú',
    'teachers-value-title': 'Profesores',
    'share-application-description':
      'Descubra la aplicación Pronote Revamp ! Una interfaz más bonita, una experiencia más agradable, notificaciones y más !',
  },
};

/** @typedef {'en'|'fr'|'es'} Language */

/** @type {Language} */
let language = 'en';

/**
 * Get user device language
 * @returns {Language} User device language (defaults to `en`)
 */
function getSystemLanguage() {
  let language = 'en';
  ['en', 'fr', 'es'].forEach((l) => {
    if (navigator.language.includes(l)) language = l;
  });
  return language;
}

language = getSystemLanguage();

// Get language from local storage
/** @type {Language} */
const overrideLanguage = localStorage.getItem('language');
if (overrideLanguage) language = overrideLanguage;
document.getElementsByTagName('html')[0].lang = language;

console.info('User language:', language);

/**
 * Set a new language
 * @param {Language} lang Language to set
 @param {boolean} saveToStorage Whether or not to save the language to local storage
 */
function setLanguage(lang, saveToStorage = false) {
  language = lang;
  document.getElementsByTagName('html')[0].lang = language;
  if (saveToStorage) localStorage.setItem('language', language);
  translatePage();
}

/**
 * Remove the saved language from the local storage
 */
function deleteSavedLanguage() {
  localStorage.removeItem('language');
  translatePage();
}

/**
 * Translate all elements with the data-lang attribute
 */
function translatePage() {
  console.debug('Translating page...');
  document.querySelectorAll('[data-lang]').forEach((e) => translateElement(e));
}

/**
 * Translate the given element to the current language
 * @param {HTMLElement} element Element to translate
 */
function translateElement(element) {
  const key = element.getAttribute('data-lang');
  const property = /\-[a-z]*\-/.exec(key)[0].replace(/\-/g, '');

  if (property === 'text') element.innerText = translations[language][key];
  else element.setAttribute(property, translations[language][key]);
}

translatePage();
